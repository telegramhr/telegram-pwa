name: deploy

on:
  workflow_dispatch:

permissions:
  contents: read

jobs:
  build:

    runs-on: self-hosted

    steps:
      - name: Deploy to production
        run: |
          su marko
          cd /home/marko/pwa
          git pull
          npm install --production
          npm run build
          if [ $? -eq 0 ]; then
            pm2 reload Telegram
            echo "✅ Deployment successful"
          else
            echo "❌ Build failed - PM2 not reloaded"
            exit 1
          fi

